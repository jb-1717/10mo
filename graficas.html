<!DOCTYPE html>
<html lang="es" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Explorador Interactivo de Gráficas y Funciones Lineales</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- KaTeX CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    <!-- KaTeX JS -->
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f4f4f4;
            color: #333;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 700px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 400px;
            }
        }
        .tab-active {
            border-color: #3b82f6;
            background-color: #eff6ff;
            color: #2563eb;
        }
        .table-row-highlight {
            background-color: #dbeafe;
            transform: scale(1.02);
            transition: all 0.2s ease-in-out;
        }
        .info-box {
            background: #fff;
            padding: 2rem;
            margin: 2rem 0;
            border-radius: 0.75rem;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
        }
        .info-box h2 {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 1rem;
        }
        .info-box p, .info-box ul {
            font-size: 1rem;
            line-height: 1.6;
            color: #4a5568;
        }
        .info-box ul {
            list-style-type: disc;
            padding-left: 1.5rem;
        }
        .info-box ul li {
            margin-bottom: 0.5rem;
        }
        button {
            transition: background-color 0.2s;
        }
    </style>
</head>
<body class="bg-stone-50 text-slate-800">

    <header class="bg-white/80 backdrop-blur-lg sticky top-0 z-50 shadow-sm">
        <nav class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <h1 class="text-xl font-bold text-blue-600">Lección Interactiva</h1>
                <div class="hidden md:flex items-center space-x-8">
                    <a href="#intro" class="text-gray-600 hover:text-blue-600 transition">Introducción</a>
                    <a href="#tipos" class="text-gray-600 hover:text-blue-600 transition">Tipos de Gráficas</a>
                    <a href="#funciones" class="text-gray-600 hover:text-blue-600 transition">Funciones Lineales</a>
                    <a href="#ejemplo" class="text-gray-600 hover:text-blue-600 transition">Ejemplo Práctico</a>
                    <a href="#conceptos" class="text-gray-600 hover:text-blue-600 transition">Conceptos Clave</a>
                </div>
            </div>
        </nav>
    </header>

    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">

        <section id="intro" class="text-center py-16">
            <h2 class="text-4xl font-bold tracking-tight text-slate-900 sm:text-5xl">Explorando Datos: Gráficas, Tablas y Funciones Lineales</h2>
            <p class="mt-6 text-lg max-w-3xl mx-auto text-slate-600">Una guía interactiva para entender cómo visualizar y analizar información de manera efectiva.</p>
        </section>

        <section class="bg-white p-8 rounded-xl shadow-md my-12">
            <h3 class="text-2xl font-bold text-center mb-8">¿Por qué es importante graficar?</h3>
            <div class="grid md:grid-cols-3 gap-8 text-center">
                <div class="flex flex-col items-center">
                    <div class="bg-blue-100 text-blue-600 rounded-full h-16 w-16 flex items-center justify-center mb-4">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" /><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" /></svg>
                    </div>
                    <h4 class="font-semibold text-lg">Visualización Clara</h4>
                    <p class="text-slate-600 mt-2">Las gráficas nos ayudan a ver patrones, tendencias y relaciones en los datos de un vistazo.</p>
                </div>
                <div class="flex flex-col items-center">
                    <div class="bg-blue-100 text-blue-600 rounded-full h-16 w-16 flex items-center justify-center mb-4">
                       <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z" /></svg>
                    </div>
                    <h4 class="font-semibold text-lg">Comunicación Efectiva</h4>
                    <p class="text-slate-600 mt-2">Es más fácil entender información compleja cuando se presenta visualmente.</p>
                </div>
                <div class="flex flex-col items-center">
                    <div class="bg-blue-100 text-blue-600 rounded-full h-16 w-16 flex items-center justify-center mb-4">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M12 6V3m0 18v-3" /><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 18a6 6 0 100-12 6 6 0 000 12z" /></svg>
                    </div>
                    <h4 class="font-semibold text-lg">Toma de Decisiones</h4>
                    <p class="text-slate-600 mt-2">Al visualizar los datos, podemos tomar decisiones más informadas y basadas en evidencia.</p>
                </div>
            </div>
        </section>

        <section id="tipos" class="py-12">
            <h3 class="text-3xl font-bold text-center mb-2">El Punto de Partida: Tablas y Tipos de Gráficas</h3>
            <p class="text-center text-slate-600 mb-10 max-w-3xl mx-auto">Todo análisis visual comienza con datos organizados en tablas. A partir de ahí, elegimos la gráfica adecuada para contar la historia que esconden los números. Explora los tipos más comunes a continuación.</p>
            <div class="border-b border-gray-200 mb-6">
                <nav class="flex -mb-px space-x-6" aria-label="Tabs">
                    <button class="tab-btn tab-active whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm" data-tab="barras">Barras</button>
                    <button class="tab-btn whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300" data-tab="lineas">Líneas</button>
                    <button class="tab-btn whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300" data-tab="circular">Circular</button>
                    <button class="tab-btn whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300" data-tab="dispersion">Dispersión</button>
                </nav>
            </div>
            <div class="grid lg:grid-cols-2 gap-8 items-center">
                <div class="prose max-w-none">
                    <div id="desc-barras" class="tab-content">
                        <h4>Gráficos de Barras</h4>
                        <p>Son perfectos para comparar cantidades entre diferentes categorías. Cada barra representa una categoría y su altura (o longitud) es proporcional al valor que representa. Son muy intuitivos y fáciles de leer.</p>
                        <p><strong>Uso ideal:</strong> Comparar ventas por producto, número de estudiantes por clase, etc.</p>
                    </div>
                    <div id="desc-lineas" class="tab-content hidden">
                        <h4>Gráficos de Líneas</h4>
                        <p>Muestran la evolución de una variable a lo largo del tiempo. Los puntos de datos se conectan con líneas, lo que facilita la visualización de tendencias, ascensos y descensos.</p>
                        <p><strong>Uso ideal:</strong> Seguimiento del precio de una acción, temperatura mensual, crecimiento de visitantes de un sitio web.</p>
                    </div>
                    <div id="desc-circular" class="tab-content hidden">
                        <h4>Gráficos Circulares (o de Pastel)</h4>
                        <p>Representan proporciones de un todo. El círculo completo equivale al 100%, y cada "porción" muestra el porcentaje que le corresponde a una categoría. Son efectivos cuando hay pocas categorías.</p>
                        <p><strong>Uso ideal:</strong> Distribución de presupuesto, cuota de mercado, resultados de una encuesta.</p>
                    </div>
                    <div id="desc-dispersion" class="tab-content hidden">
                        <h4>Gráficos de Dispersión</h4>
                        <p>Se utilizan para visualizar la relación entre dos variables numéricas. Cada punto en el gráfico representa un par de valores (x, y). Permiten identificar correlaciones, patrones y valores atípicos.</p>
                        <p><strong>Uso ideal:</strong> Relacionar horas de estudio con calificaciones, peso con altura, etc. ¡Lo exploraremos a fondo más adelante!</p>
                    </div>
                </div>
                <div class="chart-container h-64 md:h-80">
                    <canvas id="commonChartsCanvas"></canvas>
                </div>
            </div>
        </section>

        <section id="funciones" class="py-12">
            <h3 class="text-3xl font-bold text-center mb-2">Profundizando en las Funciones Lineales</h3>
            <p class="text-center text-slate-600 mb-10 max-w-3xl mx-auto">Una función lineal describe una relación constante entre dos variables. Su fórmula es $y = mx + b$ y su gráfica es siempre una línea recta. ¡Interactúa con los controles para ver cómo funciona!</p>
            <div class="bg-white p-8 rounded-xl shadow-md">
                <div class="grid lg:grid-cols-2 gap-8 items-center">
                    <div>
                        <h4 class="font-semibold text-lg mb-4">Controla la Ecuación: $y = mx + b$</h4>
                        <div class="mb-6">
                            <label for="slider-m" class="font-medium">Pendiente ($m$): <span id="m-value" class="font-bold text-blue-600">1</span></label>
                            <input type="range" id="slider-m" min="-10" max="10" value="1" step="0.5" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer">
                            <p id="m-desc" class="text-sm text-slate-600 mt-1">Una pendiente positiva indica que 'y' aumenta cuando 'x' aumenta.</p>
                        </div>
                        <div>
                            <label for="slider-b" class="font-medium">Intersección Y ($b$): <span id="b-value" class="font-bold text-blue-600">0</span></label>
                            <input type="range" id="slider-b" min="-10" max="10" value="0" step="1" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer">
                            <p class="text-sm text-slate-600 mt-1">Este es el valor de 'y' cuando la línea cruza el eje vertical ($x=0$).</p>
                        </div>
                    </div>
                    <div class="chart-container">
                        <canvas id="linearFunctionCanvas"></canvas>
                    </div>
                </div>
            </div>
        </section>

        <section id="ejemplo" class="py-12">
            <h3 class="text-3xl font-bold text-center mb-2">Ejemplo Práctico: De la Tabla a la Gráfica</h3>
            <p class="text-center text-slate-600 mb-10 max-w-3xl mx-auto">Veamos cómo se aplica esto a un caso real. Analizaremos la relación entre las horas de estudio de un estudiante y la calificación obtenida en un examen. Pasa el cursor sobre los puntos del gráfico para ver su correspondencia en la tabla.</p>
            <div class="grid lg:grid-cols-3 gap-8">
                <div class="lg:col-span-1 bg-white p-6 rounded-xl shadow-md">
                    <h4 class="font-semibold text-lg mb-4">Datos de Estudio</h4>
                    <div class="overflow-x-auto">
                        <table class="min-w-full divide-y divide-gray-200">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Horas (x)</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Calificación (y)</th>
                                </tr>
                            </thead>
                            <tbody id="dataTableBody" class="bg-white divide-y divide-gray-200">
                                <!-- Filas de datos generadas por JS -->
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="lg:col-span-2 bg-white p-6 rounded-xl shadow-md">
                    <div class="flex justify-between items-center mb-4">
                        <h4 class="font-semibold text-lg">Gráfico de Dispersión: Horas vs. Calificación</h4>
                        <button id="toggleTrendlineBtn" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-lg transition">Mostrar Línea de Tendencia</button>
                    </div>
                    <div class="chart-container h-[450px]">
                        <canvas id="scatterPlotCanvas"></canvas>
                    </div>
                    <p id="scatter-interpretation" class="text-sm text-slate-600 mt-4 text-center"></p>
                </div>
            </div>
        </section>

        <section id="conceptos" class="py-12">
            <h3 class="text-3xl font-bold text-center mb-2">Conceptos Clave y Ejemplos Adicionales</h3>
            <p class="text-center text-slate-600 mb-10 max-w-3xl mx-auto">Refuerza tu aprendizaje con estos ejemplos y explicaciones detalladas.</p>

            <div class="info-box">
                <h2>¿Qué es una función lineal?</h2>
                <p>Una función lineal es una ecuación matemática que describe una relación constante entre dos variables. Tiene la forma:</p>
                <p>$$ y = mx + b $$</p>
                <ul>
                    <li>$y$: valor resultante o dependiente.</li>
                    <li>$x$: valor independiente o de entrada.</li>
                    <li>$m$: <strong>pendiente</strong> de la recta (indica cuánto cambia $y$ por cada unidad que aumenta $x$).</li>
                    <li>$b$: <strong>intersección Y</strong> (el valor donde la recta cruza el eje $y$, cuando $x = 0$).</li>
                </ul>
                <br>
                <p><strong>Ejemplo de aplicación</strong></p>
                <p>Supongamos que tenemos la función $y = 2x + 3$. ¿Cuál es el valor de $y$ cuando $x = 4$?</p>
                <br>
                <strong>Solución</strong>
                <ul>
                    <li>Partimos de la función: $y = 2x + 3$</li>
                    <li>Sustituimos $x$ por 4: $y = 2(4) + 3$</li>
                    <li>Multiplicamos: $y = 8 + 3$</li>
                    <li>Sumamos: $y = 11$</li>
                    <li>Por lo tanto, cuando $x = 4$, el valor de $y$ es 11. Este resultado se puede comprobar viendo la gráfica de abajo.</li>
                </ul>
                <div class="chart-container h-[250px]">
                    <img src="https://quickchart.io/chart?c=%7Btype%3A'line'%2Cdata%3A%7Blabels%3A%5B0%2C1%2C2%2C3%2C4%2C5%5D%2Cdatasets%3A%5B%7Blabel%3A'y%20%3D%202x%20%2B%203'%2Cdata%3A%5B3%2C5%2C7%2C9%2C11%2C13%5D%2Cfill%3Afalse%2CborderColor%3A'blue'%7D%5D%7D%2Coptions%3A%7Btitle%3A%7Bdisplay%3Atrue%2Ctext%3A'Gr%C3%A1fica%20de%20y%20%3D%202x%20%2B%203'%7D%2Cscales%3A%7BxAxes%3A%5B%7BscaleLabel%3A%7Bdisplay%3Atrue%2ClabelString%3A'x'%7D%7D%5D%2CyAxes%3A%5B%7BscaleLabel%3A%7Bdisplay%3Atrue%2ClabelString%3A'y'%7D%7D%5D%7D%7D%7D" alt="Gráfica de y = 2x + 3" class="mx-auto my-4 w-full h-full object-contain">
                </div>
            </div>

            <div class="info-box">
                <h2>Interpretar pendientes y calcular calificaciones</h2>
                <p>La pendiente de una recta indica la tasa de cambio entre dos variables. En este caso, la calificación de un estudiante depende de las horas que estudia.</p>
                <br>
                <p><strong>Ejemplo de aplicación</strong></p>
                <p>Un estudiante estudia por 3 horas y obtiene una calificación de 80 puntos. Si la relación entre horas de estudio y calificación es lineal y se sabe que por 0 horas de estudio la calificación es 50 puntos, ¿cuál es la pendiente de la función lineal que describe esta relación?</p>
                <br>
                <p><strong>Solución</strong></p>
                <p>Tenemos que un estudiante que no estudia, es decir que estudió 0 horas, logra sacar 50 puntos y también tenemos que otro estudiante que estudió 3 horas obtiene 80 puntos. Podemos hallar la pendiente con la fórmula:</p>
                <p>$$ m = \frac{y_2 - y_1}{x_2 - x_1} = \frac{80\,pts - 50\,pts}{3\,h - 0\,h} = \frac{30\,pts}{3\,h} = 10\frac{pts}{h} $$</p>
                <p>Entonces, la función que modela esta relación es: $y = (10\frac{pts}{h}) x + 50\,pts$</p>
                <br>
                <p><strong>¿Qué calificación tendría un estudiante que estudia 5 horas?</strong></p>
                <ul>
                    <li>Usamos la función: $y = (10\frac{pts}{h}) x + 50\,pts$</li>
                    <li>Reemplazamos $x = 5\,h$ y nos queda: $y = (10\frac{pts}{h})(5\,h) + 50\,pts$</li>
                    <li>Multiplicamos: $y = 50\,pts + 50\,pts$</li>
                    <li>Resultado: $y = 100\,pts$</li>
                    <li>Un estudiante que estudia 5 horas sacaría 100 puntos. Este resultado se puede comprobar observando la gráfica de abajo.</li>
                </ul>
                <div class="chart-container h-[250px]">
                    <img src="https://quickchart.io/chart?c=%7Btype%3A'line'%2Cdata%3A%7Blabels%3A%5B0%2C1%2C2%2C3%2C4%2C5%5D%2Cdatasets%3A%5B%7Blabel%3A'y%20%3D%2010x%20%2B%2050'%2Cdata%3A%5B50%2C60%2C70%2C80%2C90%2C100%5D%2Cfill%3Afalse%2CborderColor%3A'green'%7D%5D%7D%2Coptions%3A%7Btitle%3A%7Bdisplay%3Atrue%2Ctext%3A'Gr%C3%A1fica%20de%20y%20%3D%2010x%20%2B%2050'%7D%2Cscales%3A%7BxAxes%3A%5B%7BscaleLabel%3A%7Bdisplay%3Atrue%2ClabelString%3A'Horas%20de%20estudio'%7D%7D%5D%2CyAxes%3A%5B%7BscaleLabel%3A%7Bdisplay%3Atrue%2ClabelString%3A'Calificaci%C3%B3n'%7D%7D%5D%7D%7D%7D" alt="Gráfica de y = 10x + 50" class="mx-auto my-4 w-full h-full object-contain">
                </div>
            </div>

            <div class="info-box">
                <h2>¿Cómo leer un gráfico de barras?</h2>
                <p>Un gráfico de barras permite comparar visualmente cantidades entre categorías. Cada barra representa una cantidad específica y su altura indica el valor correspondiente.</p>
                <br>
                <p><strong>Ejemplo de aplicación</strong></p>
                <p>Un gráfico de barras muestra que un producto A vendió 150 unidades y que un producto B vendió 200 unidades. Si el producto C vendió la mitad de las unidades del producto B, ¿cuántas unidades vendió el producto C?</p>
                <br>
                <p><strong>Solución</strong></p>
                <p><strong>¿Cómo sabemos que el producto C vendió la mitad que el B?</strong></p>
                <ul>
                    <li>Producto B: 200 unidades</li>
                    <li>La mitad de 200 se calcula así: $$ \frac{200}{2} = 100 $$</li>
                    <li>Por lo tanto, el producto C vendió 100 unidades.</li>
                    <li>Esto se puede verificar visualmente: la barra de C mide la mitad que la de B.</li>
                </ul>
                <div class="chart-container h-[250px]">
                    <img src="https://quickchart.io/chart?c=%7Btype%3A'bar'%2Cdata%3A%7Blabels%3A%5B'Producto%20A'%2C'Producto%20B'%2C'Producto%20C'%5D%2Cdatasets%3A%5B%7Blabel%3A'Unidades%20vendidas'%2Cdata%3A%5B150%2C200%2C100%5D%7D%5D%7D%2Coptions%3A%7Btitle%3A%7Bdisplay%3Atrue%2Ctext%3A'Gr%C3%A1fico%20de%20barras%20de%20ventas%20por%20producto'%7D%2Cscales%3A%7BxAxes%3A%5B%7BscaleLabel%3A%7Bdisplay%3Atrue%2ClabelString%3A'Producto'%7D%7D%5D%2CyAxes%3A%5B%7Bticks%3A%7BbeginAtZero%3Atrue%2Cmin%3A0%2Cmax%3A200%7D%2CscaleLabel%3A%7Bdisplay%3Atrue%2ClabelString%3A'Unidades%20vendidas'%7D%7D%5D%7D%7D%7D" alt="Gráfico de barras de productos" class="mx-auto my-4 w-full h-full object-contain">
                </div>

                <p>Se puede decir que en resumen tenemos que:</p>
                <ul>
                    <li>El producto A vendió 150 unidades.</li>
                    <li>El producto B vendió 200 unidades.</li>
                    <li>El producto C vendió 100 unidades.</li>
                </ul>
            </div>
        </section>

    </main>

    <footer class="bg-slate-800 text-white mt-12 py-8">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <h4 class="text-2xl font-bold mb-4">¡Ahora es Tu Turno de Explorar!</h4>
            <p class="max-w-3xl mx-auto text-slate-300 mb-6">¿En qué otras situaciones crees que sería útil un gráfico de dispersión? ¿Qué tipo de gráfica usarías para mostrar el porcentaje de estudiantes en diferentes clubes escolares?</p>
            <p class="text-slate-400">Aplicación interactiva de aprendizaje.</p>
        </div>
    </footer>

<script>
document.addEventListener('DOMContentLoaded', () => {
    try {
        // Configurar KaTeX auto-render
        if (typeof renderMathInElement === 'function') {
            renderMathInElement(document.body, {
                delimiters: [
                    {left: '$$', right: '$$', display: true},
                    {left: '$', right: '$', display: false},
                ],
                throwOnError: false
            });
        } else {
            console.warn('KaTeX auto-render no se cargó correctamente');
        }

        const chartData = {
            barras: {
                type: 'bar',
                data: {
                    labels: ['Producto A', 'Producto B', 'Producto C', 'Producto D'],
                    datasets: [{
                        label: 'Ventas (miles)',
                        data: [12, 19, 3, 5],
                        backgroundColor: ['#60a5fa', '#3b82f6', '#2563eb', '#1d4ed8']
                    }]
                },
                options: { scales: { y: { beginAtZero: true } } }
            },
            lineas: {
                type: 'line',
                data: {
                    labels: ['Ene', 'Feb', 'Mar', 'Abr', 'May', 'Jun'],
                    datasets: [{
                        label: 'Temperatura (°C)',
                        data: [15, 17, 20, 22, 25, 28],
                        borderColor: '#3b82f6',
                        tension: 0.1
                    }]
                }
            },
            circular: {
                type: 'pie',
                data: {
                    labels: ['Marketing', 'Ventas', 'Desarrollo', 'Soporte'],
                    datasets: [{
                        label: 'Distribución de Presupuesto',
                        data: [30, 40, 20, 10],
                        backgroundColor: ['#60a5fa', '#3b82f6', '#2563eb', '#1d4ed8']
                    }]
                }
            },
            dispersion: {
                type: 'scatter',
                data: {
                    datasets: [{
                        label: 'Relación X-Y',
                        data: [{x: 1, y: 2}, {x: 2, y: 3.5}, {x: 3, y: 4}, {x: 4, y: 6}, {x: 5, y: 5.5}],
                        backgroundColor: '#3b82f6'
                    }]
                }
            }
        };

        let commonChart;
        const commonChartsCanvas = document.getElementById('commonChartsCanvas');

        if (!commonChartsCanvas) {
            console.error('No se encontró el canvas para gráficos comunes');
        } else {
            const ctx = commonChartsCanvas.getContext('2d');

            // Renderizar el gráfico común basado en el tipo seleccionado
            function renderCommonChart(type) {
                try {
                    if (commonChart) {
                        commonChart.destroy();
                    }
                    const config = chartData[type];
                    commonChart = new Chart(ctx, {
                        type: config.type,
                        data: config.data,
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: { legend: { display: config.type !== 'bar' } }
                        }
                    });
                } catch (e) {
                    console.error('Error al renderizar gráfico común:', e);
                }
            }

            // Lógica para los botones de las pestañas
            const tabButtons = document.querySelectorAll('.tab-btn');
            const tabContents = document.querySelectorAll('.tab-content');

            if (tabButtons.length && tabContents.length) {
                tabButtons.forEach(button => {
                    button.addEventListener('click', () => {
                        const tab = button.dataset.tab;

                        tabButtons.forEach(btn => btn.classList.remove('tab-active'));
                        button.classList.add('tab-active');

                        tabContents.forEach(content => content.classList.add('hidden'));
                        document.getElementById(`desc-${tab}`).classList.remove('hidden');

                        renderCommonChart(tab);
                    });
                });

                renderCommonChart('barras');
            } else {
                console.warn('No se encontraron botones de pestañas o contenidos');
            }
        }

        // Controles para la función lineal
        const mSlider = document.getElementById('slider-m');
        const bSlider = document.getElementById('slider-b');
        const mValueSpan = document.getElementById('m-value');
        const bValueSpan = document.getElementById('b-value');
        const mDesc = document.getElementById('m-desc');
        const linearFunctionCanvas = document.getElementById('linearFunctionCanvas');

        if (!linearFunctionCanvas) {
            console.error('No se encontró el canvas para la función lineal');
        } else {
            const linearCtx = linearFunctionCanvas.getContext('2d');
            let linearChart;

            try {
                linearChart = new Chart(linearCtx, {
                    type: 'line',
                    data: {
                        datasets: [{
                            label: 'y = mx + b',
                            data: [],
                            borderColor: '#ef4444',
                            backgroundColor: '#ef4444',
                            tension: 0.1,
                            pointRadius: 0
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            x: {
                                type: 'linear',
                                position: 'bottom',
                                title: { display: true, text: 'Eje X' },
                                min: -10,
                                max: 10
                            },
                            y: {
                                title: { display: true, text: 'Eje Y' },
                                min: -100,
                                max: 100
                            }
                        },
                        plugins: {
                            legend: { display: false }
                        }
                    }
                });

                // Función para actualizar el gráfico lineal
                function updateLinearChart() {
                    try {
                        const m = parseFloat(mSlider.value);
                        const b = parseFloat(bSlider.value);

                        mValueSpan.textContent = m;
                        bValueSpan.textContent = b;

                        if (m > 0) mDesc.textContent = "Pendiente positiva: 'y' aumenta cuando 'x' aumenta.";
                        else if (m < 0) mDesc.textContent = "Pendiente negativa: 'y' disminuye cuando 'x' aumenta.";
                        else mDesc.textContent = "Pendiente cero: 'y' se mantiene constante.";

                        const data = [];
                        for (let x = -10; x <= 10; x += 0.5) {
                            data.push({x: x, y: m * x + b});
                        }

                        linearChart.data.datasets[0].data = data;
                        linearChart.update();
                    } catch (e) {
                        console.error('Error al actualizar gráfico lineal:', e);
                    }
                }

                if (mSlider && bSlider && mValueSpan && bValueSpan && mDesc) {
                    mSlider.addEventListener('input', updateLinearChart);
                    bSlider.addEventListener('input', updateLinearChart);
                    updateLinearChart();
                } else {
                    console.warn('Faltan elementos para los controles de la función lineal');
                }
            } catch (e) {
                console.error('Error al crear gráfico lineal:', e);
            }
        }

        // Datos para el ejemplo práctico de dispersión
        const scatterData = [
            { x: 2, y: 60 }, { x: 4, y: 70 },
            { x: 6, y: 80 }, { x: 8, y: 90 },
            { x: 1, y: 55 }, { x: 5, y: 78 },
            { x: 7, y: 85 }, { x: 9, y: 98 }
        ].sort((a,b) => a.x - b.x);

        const tableBody = document.getElementById('dataTableBody');
        if (tableBody) {
            scatterData.forEach((d, index) => {
                const row = document.createElement('tr');
                row.dataset.index = index;
                row.innerHTML = `<td class="px-6 py-4 whitespace-nowrap">${d.x}</td><td class="px-6 py-4 whitespace-nowrap">${d.y}</td>`;
                tableBody.appendChild(row);
            });
        } else {
            console.warn('No se encontró el cuerpo de la tabla de datos');
        }

        const scatterPlotCanvas = document.getElementById('scatterPlotCanvas');
        if (!scatterPlotCanvas) {
            console.error('No se encontró el canvas para el gráfico de dispersión');
        } else {
            const scatterCtx = scatterPlotCanvas.getContext('2d');
            let scatterPlot;

            try {
                scatterPlot = new Chart(scatterCtx, {
                    type: 'scatter',
                    data: {
                        datasets: [{
                            label: 'Datos de Estudiantes',
                            data: scatterData,
                            backgroundColor: '#3b82f6',
                            pointRadius: 6,
                            pointHoverRadius: 8
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            x: { title: { display: true, text: 'Horas de Estudio' }, min: 0, max: 10 },
                            y: { title: { display: true, text: 'Calificación Obtenida' }, min: 40, max: 100 }
                        },
                        plugins: {
                            legend: { display: false }
                        },
                        onHover: (event, chartElement) => {
                            const tableRows = tableBody ? tableBody.querySelectorAll('tr') : [];
                            tableRows.forEach(row => row.classList.remove('table-row-highlight'));
                            if(chartElement.length > 0) {
                                const index = chartElement[0].index;
                                const row = tableBody.querySelector(`tr[data-index='${index}']`);
                                if(row) {
                                    row.classList.add('table-row-highlight');
                                }
                            }
                        }
                    }
                });

                // Datos para la línea de tendencia
                const trendlineData = {
                    label: 'Línea de Tendencia (y ≈ 5x + 50)',
                    data: [{x:0, y:50}, {x:10, y:100}],
                    type: 'line',
                    borderColor: '#f97316',
                    backgroundColor: '#f97316',
                    pointRadius: 0,
                    borderDash: [5, 5]
                };

                const scatterInterpretation = document.getElementById('scatter-interpretation');
                const toggleBtn = document.getElementById('toggleTrendlineBtn');

                if (toggleBtn) {
                    let trendlineVisible = false;
                    toggleBtn.addEventListener('click', () => {
                        try {
                            trendlineVisible = !trendlineVisible;
                            if (trendlineVisible) {
                                scatterPlot.data.datasets.push(trendlineData);
                                toggleBtn.textContent = 'Ocultar Línea de Tendencia';
                                toggleBtn.classList.replace('bg-blue-500', 'bg-orange-500');
                                toggleBtn.classList.replace('hover:bg-blue-600', 'hover:bg-orange-600');
                                if (scatterInterpretation) {
                                    scatterInterpretation.textContent = "La línea naranja muestra la tendencia general: a más horas de estudio, mayor es la calificación esperada. Esto indica una fuerte relación lineal positiva.";
                                }
                            } else {
                                scatterPlot.data.datasets.pop();
                                toggleBtn.textContent = 'Mostrar Línea de Tendencia';
                                toggleBtn.classList.replace('bg-orange-500', 'bg-blue-500');
                                toggleBtn.classList.replace('hover:bg-orange-600', 'hover:bg-blue-600');
                                if (scatterInterpretation) {
                                    scatterInterpretation.textContent = "";
                                }
                            }
                            scatterPlot.update();
                        } catch (e) {
                            console.error('Error al alternar línea de tendencia:', e);
                        }
                    });
                } else {
                    console.warn('No se encontró el botón de alternar línea de tendencia');
                }
            } catch (e) {
                console.error('Error al crear gráfico de dispersión:', e);
            }
        }
    } catch (e) {
        console.error('Error global en la aplicación:', e);
    }
});
</script>

</body>
</html>
